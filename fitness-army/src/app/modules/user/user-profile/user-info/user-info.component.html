<div class="wrapper">
  <div class="header">
    <h2 class="head">Setup your profile</h2>
  </div>
  <div class="container">
    <nz-spin [nzSpinning]="true" *ngIf="fetchingData"></nz-spin>
    <ng-container *ngIf="!fetchingData">
      <div class="left">
        <div class="profile-image-wrapper">
          <img [src]="user?.profileImage"/>
        </div>
        <span class="user-name">{{user?.displayName}}</span>
        <span class="user-email">{{user?.email}}</span>
      </div>
      <div class="right">
        <ng-container *ngIf="!userBodyStats || editMode else bodyStats">
          <form nz-form [formGroup]="userBodyStatsForm" class="user-stats-form">
            <nz-form-item>
              <nz-form-label nzFor="birthDate">Date of birth</nz-form-label>
              <nz-form-control nzHasFeedback nzErrorTip="Please select a date!">
                <nz-date-picker [style]="{display: 'block', width: '100%'}" nzFormat="yyyy-MM-dd HH:mm:ss"
                                id="birthDate"
                                formControlName="dateOfBirth"></nz-date-picker>
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-label nzFor="weight">Weight</nz-form-label>
              <nz-form-control nzHasFeedback nzErrorTip="Please enter valid weight!">
                <input nz-input id="weight" type="number" step="0.1" formControlName="weight"/>
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-label nzFor="height">Height</nz-form-label>
              <nz-form-control nzHasFeedback nzErrorTip="Please enter valid height!">
                <input nz-input id="height" type="number" step="0.1" formControlName="height"/>
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-label>Gender</nz-form-label>
              <nz-form-control nzHasFeedback nzErrorTip="Please select gender!">
                <nz-radio-group formControlName="gender">
                  <label nz-radio nzValue="male">Male</label>
                  <label nz-radio nzValue="female">Female</label>
                </nz-radio-group>
              </nz-form-control>
            </nz-form-item>
            <div class="action-button">
              <button nz-button nzType="primary" (click)="editMode ? onUserProfileUpdate()
               : onUserProfileCreate()">{{editMode ? 'Update': 'Create'}}</button>
              <button *ngIf="editMode" nz-button nzType="default" (click)="editMode = !editMode">Back</button>
            </div>
          </form>
        </ng-container>
      </div>
    </ng-container>
  </div>
</div>


<ng-template #bodyStats>
  <div class="user-stats-wrapper">
    <div class="container">
      <div class="left-section">
        <div class="chart-wrapper">
          <div echarts [options]="options"></div>
        </div>
        <p class="user-bfp">Body fat percentage: {{userBodyStats?.bodyFatPercentage?.bodyFatPercentage + ' %'}}</p>
      </div>
      <div class="right-section">
        <div class="user-gender-image-wrapper">
          <img [src]="setUserGenderPhoto()">
          <span class="user-height">{{userBodyStats?.bodyStats?.height}} cm</span>
        </div>
        <div class="user-stats-data-wrapper">
          <div class="user-stats-data">
            <div class="user-stats-data-item">
              <span class="user-stats-data-item-label">Age</span>
              <span class="user-stats-data-item-value">{{userBodyStats?.bodyStats?.age}}</span>
            </div>
            <div class="user-stats-data-item">
              <span class="user-stats-data-item-label">Current Weight</span>
              <span class="user-stats-data-item-value">{{userBodyStats?.bodyStats?.weight + ' kg'}}</span>
            </div>
            <div class="user-stats-data-item">
              <span class="user-stats-data-item-label">BMI</span>
              <span class="user-stats-data-item-value">{{userBodyStats?.bodyMassIndex?.bmi + '%'}}</span>
            </div>
            <div class="user-stats-data-item">
              <span class="user-stats-data-item-label">Health stats</span>
              <span class="user-stats-data-item-value">{{userBodyStats?.bodyMassIndex?.health}}</span>
            </div>
            <div class="user-stats-data-item">
              <span class="user-stats-data-item-label">Healthy BMI range</span>
              <span class="user-stats-data-item-value">{{userBodyStats?.bodyMassIndex?.healthyBmiRange}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="update-button-wrapper">
      <button class="update-button" nz-button nzType="primary" (click)="enterEditMode()">Update body stats</button>
    </div>
  </div>
</ng-template>
